% Вихідні параметри
Cb1 = 29.4; Cb2 = 0.1; k1 = 1; k2 = 1;
w1 = 0.1; % постійний потік
w2 = 0.1; % фіксований потік для тестування
h0 = 1; % початковий рівень розчину
Cb0 = 0.5; % початкова концентрація

% Диференціальні рівняння
dynamics = @(t, y) [
    w1 + w2 - 0.2*sqrt(y(1)); % dh/dt
    ((Cb1 - y(2))*w1 + (Cb2 - y(2))*w2)/y(1) - (k1*y(2))/((1 + k2*y(2))^2) % dCb/dt
];

% Початкові умови
y0 = [h0; Cb0]; % [h, Cb]

% Інтегрування
[t, y] = ode45(dynamics, [0, 100], y0);

% Графіки
figure;
subplot(2,1,1);
plot(t, y(:,1)); title('Рівень розчину (h)'); xlabel('Час'); ylabel('h');

subplot(2,1,2);
plot(t, y(:,2)); title('Концентрація продукту (Cb)'); xlabel('Час'); ylabel('C_b');

predcstr

% Параметри моделі
Cb1 = 29.4; % Концентрація першої речовини
Cb2 = 0.1;  % Концентрація другої речовини
k1 = 1;     % Константа швидкості реакції
k2 = 1;     % Константа насичення реакції
h0 = 1;     % Початковий рівень розчину (м)
Cb0 = 0.5;  % Початкова концентрація (моль/л)
w20 = 0.1;  % Початкове значення додаткового потоку

% Динамічний вхідний сигнал (синусоїдальний потік)
w1 = @(t) 0.1 + 0.05 * sin(0.005 * t); % Середнє значення 0.1, амплітуда 0.05

% Диференціальні рівняння для моделі
dynamics = @(t, y) [
    w1(t) + y(2) - 0.2 * sqrt(max(y(1), 0)); % dh/dt (зміна рівня розчину)
    (Cb1 - y(3)) * w1(t) / max(y(1), 1e-6) + (Cb2 - y(3)) * y(2) / max(y(1), 1e-6) - (k1 * y(3)) / ((1 + k2 * y(3))^2); % dCb/dt (зміна концентрації)
    0.01 * (y(1) - 1.5) - 0.02 * y(2) % dw2/dt (зміна додаткового потоку)
];

% Початкові умови
y0 = [h0; w20; Cb0]; % [h, w2, Cb] - рівень, потік, концентрація

% Інтегрування за допомогою ode45
[t, y] = ode45(dynamics, [0, 1600], y0);

% Розділення змінних для аналізу
h = y(:, 1); % Рівень розчину
w2 = y(:, 2); % Додатковий потік
Cb = y(:, 3); % Концентрація Cb

% Побудова графіків
figure;

% Вхідний сигнал (потік w1)
subplot(3,1,1);
plot(t, arrayfun(w1, t), 'r', 'LineWidth', 1.5); % Вхідний сигнал (залежить від часу)
title('Вхідний сигнал (потік w_1)');
xlabel('Час (с)');
ylabel('Потік w_1');
grid on;

% Рівень розчину (h)
subplot(3,1,2);
plot(t, h, 'g', 'LineWidth', 1.5); % Рівень розчину
title('Рівень розчину (h)');
xlabel('Час (с)');
ylabel('Рівень (м)');
grid on;

% Вихідний сигнал (концентрація Cb)
subplot(3,1,3);
plot(t, Cb, 'b', 'LineWidth', 1.5); % Вихідна концентрація
title('Вихідний сигнал (концентрація C_b)');
xlabel('Час (с)');
ylabel('Концентрація C_b');
grid on;
